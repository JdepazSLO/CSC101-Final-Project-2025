import main_code
import Air_Qual
import unittest



class TestCode(unittest.TestCase):

    def test_get_counties(self):
        data_one = [["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Fresno"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Chico"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Fresno"]
                    ]
        data_two = [["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Alameda"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Fresno"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Butte"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Amador"]
                    ]
        data_three = [["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "El Dorado"],
                      ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Glenn"],
                      ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Imperial"],
                      ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Fresno"]
                      ]
        data = [data_one, data_two, data_three]
        result = main_code.get_counties(data)
        expected = ["Fresno","Monterey","Chico","Alameda","Butte","Amador","El Dorado","Glenn","Imperial"]
        self.assertEqual(result, expected)

    def test_get_sites(self):
        data_one = [["", "", "", "", "", "", "", "Soledad", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "", "Salinas", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "", "Soledad", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "", "Seaside", "", "", "", "", "", "", "", "", "", "", "Monterey"]
                    ]
        data_two = [["", "", "", "", "", "", "", "Seaside", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "", "Soledad", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "", "Greenfield", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "", "Gonzales", "", "", "", "", "", "", "", "", "", "", "Monterey"]
                    ]
        data_three = [["", "", "", "", "", "", "", "Gonzales", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                      ["", "", "", "", "", "", "", "Watsonville", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                      ["", "", "", "", "", "", "", "Soledad", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                      ["", "", "", "", "", "", "", "Salinas", "", "", "", "", "", "", "", "", "", "", "Monterey"]
                      ]
        data = [data_one, data_two, data_three]
        result = main_code.get_sites(data)
        expected = ["Soledad", "Salinas", "Seaside", "Greenfield", "Gonzales", "Watsonville"]
        self.assertEqual(result, expected)




    def test_filter_counties_fresno(self):
        data_one = [["","","","","","","","","","","","","","","","","","","Fresno"],
                ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "","Monterey"],
                ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "","Chico"],
                ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "","Fresno"]
                ]
        data_two =  [["","","","","","","","","","","","","","","","","","","Alameda"],
                ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "","Fresno"],
                ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "","Butte"],
                ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "","Amador"]
                ]
        data_three = [["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "El Dorado"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Glenn"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Imperial"],
                    ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Fresno"]
                    ]
        data = [data_one, data_two, data_three]
        county = "Fresno"
        result = main_code.fil(county, data)
        expected = [[["","","","","","","","","","","","","","","","","","","Fresno"],["","","","","","","","","","","","","","","","","","","Fresno"]],[["","","","","","","","","","","","","","","","","","","Fresno"]],[["","","","","","","","","","","","","","","","","","","Fresno"]]]
        self.assertEqual(expected, result)

    def test_filter_sites_city(self):
        data_one = [["","","","","","","","city","","","","","","","","","","","Fresno"],
                ["", "", "", "", "", "", "", "place", "", "", "", "", "", "", "", "", "", "","Monterey"],
                ["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "","Chico"],
                ["", "", "", "", "", "", "", "location", "", "", "", "", "", "", "", "", "", "","Fresno"]
                ]
        data_two =  [["","","","","","","","location","","","","","","","","","","","Alameda"],
                ["", "", "", "", "", "", "", "coord", "", "", "", "", "", "", "", "", "", "","Fresno"],
                ["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "","Butte"],
                ["", "", "", "", "", "", "", "lugar", "", "", "", "", "", "", "", "", "", "","Amador"]
                ]
        data_three = [["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "El Dorado"],
                    ["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Glenn"],
                    ["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Imperial"],
                    ["", "", "", "", "", "", "", "there", "", "", "", "", "", "", "", "", "", "", "city county"]
                    ]
        data = [data_one, data_two, data_three]
        site = "city"
        result = main_code.fil(site, data)
        expected = [[["","","","","","","","city","","","","","","","","","","","Fresno"],["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "","Chico"]],[["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "","Butte"]],[["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "El Dorado"],["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Glenn"],["", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Imperial"]]]
        self.assertEqual(result, expected)

    def test_filter_months_december(self):
        data_one = [["12/25", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Fresno"],
                    ["03/23", "", "", "", "", "", "", "place", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["09/29", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Chico"],
                    ["04/24", "", "", "", "", "", "", "location", "", "", "", "", "", "", "", "", "", "", "Fresno"]
                    ]
        data_two = [["07/22", "", "", "", "", "", "", "location", "", "", "", "", "", "", "", "", "", "", "Alameda"],
                    ["12/12", "", "", "", "", "", "", "coord", "", "", "", "", "", "", "", "", "", "", "Fresno"],
                    ["12/02", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Butte"],
                    ["01/01", "", "", "", "", "", "", "lugar", "", "", "", "", "", "", "", "", "", "", "Amador"]
                    ]
        data_three = [["05/03", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "El Dorado"],
                      ["04/13", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Glenn"],
                      ["08/17", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Imperial"],
                      ["12/25", "", "", "", "", "", "", "there", "", "", "", "", "", "", "", "", "", "", "city county"]
                      ]
        data = [data_one, data_two, data_three]
        month = "12"
        result = main_code.fil(month, data)
        expected = [[["12/25", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Fresno"]],
                    [["12/12", "", "", "", "", "", "", "coord", "", "", "", "", "", "", "", "", "", "", "Fresno"],
                     ["12/02", "", "", "", "", "", "", "city", "", "", "", "", "", "", "", "", "", "", "Butte"]],
                    [["12/25", "", "", "", "", "", "", "there", "", "", "", "", "", "", "", "", "", "", "city county"]]]
        self.assertEqual(result, expected)

    def test_most_pol(self):
        data_one = [["","","","","","","0",""], #extra empty list to account for title item in real datasets
            ["","","","","","","12","Soledad"],
                    ["", "", "", "", "", "", "23", "Salinas"],
                    ["", "", "", "", "", "", "56", "Monterey"],
                    ["", "", "", "", "", "", "9", "Gonzales"],
                    ]
        data_two = [["","","","","","","0",""],
            ["","","","","","","64","San Jose"],
                    ["", "", "", "", "", "", "32", "San Francisco"],
                    ["", "", "", "", "", "", "8", "Oakland"],
                    ["", "", "", "", "", "", "76", "Santa Clara"],
                    ]
        data_three = [["","","","","","","0",""],
            ["","","","","","","88","Greenfield"],
                    ["", "", "", "", "", "", "85", "Prunedale"],
                    ["", "", "", "", "", "", "23", "Santa Cruz"],
                    ["", "", "", "", "", "", "12", "Watsonville"],
                    ]
        data = [data_one, data_two, data_three]
        result = main_code.most_pol(data)
        expected = [["Monterey"],["San Jose","Santa Clara"],["Greenfield","Prunedale"],[56,76,88]]
        self.assertEqual(result, expected)

    def test_air_qual_fresno(self):
        data_one = [["", "", "", "", "", "", "23", "", "", "", "", "", "", "", "", "", "", "", "Fresno"], #90 / 2 = 45
                    ["", "", "", "", "", "", "34", "", "", "", "", "", "", "", "", "", "", "", "Monterey"],
                    ["", "", "", "", "", "", "53", "", "", "", "", "", "", "", "", "", "", "", "Chico"],
                    ["", "", "", "", "", "", "67", "", "", "", "", "", "", "", "", "", "", "", "Fresno"]
                    ]
        data_two = [["", "", "", "", "", "", "23", "", "", "", "", "", "", "", "", "", "", "", "Alameda"], #43 / 1 = 43
                    ["", "", "", "", "", "", "43", "", "", "", "", "", "", "", "", "", "", "", "Fresno"],
                    ["", "", "", "", "", "", "12", "", "", "", "", "", "", "", "", "", "", "", "Butte"],
                    ["", "", "", "", "", "", "56", "", "", "", "", "", "", "", "", "", "", "", "Amador"]
                    ]
        data_three = [["", "", "", "", "", "", "66", "", "", "", "", "", "", "", "", "", "", "", "El Dorado"], #25 / 1 = 25
                      ["", "", "", "", "", "", "13", "", "", "", "", "", "", "", "", "", "", "", "Glenn"],
                      ["", "", "", "", "", "", "13", "", "", "", "", "", "", "", "", "", "", "", "Imperial"],
                      ["", "", "", "", "", "", "25", "", "", "", "", "", "", "", "", "", "", "", "Fresno"]
                      ]
        data = [data_one, data_two, data_three]
        result = Air_Qual.air_qual("Fresno", data)
        expected = Air_Qual.find_pollution(45.0,43.0,25.0,37.67)   #AQI: 45+43+25/3 = 28.25
        self.assertEqual(expected, result)

